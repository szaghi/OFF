<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OFF: Data_Type_BC.f90 Source File</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OFF
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('d3/dac/Data__Type__BC_8f90.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Data_Type_BC.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d3/dac/Data__Type__BC_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00003"></a>00003 <span class="keyword">module</span> <a class="code" href="../../d3/d18/classData__Type__BC.html">Data_Type_BC</a>
<a name="l00004"></a>00004 <span class="comment">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00005"></a>00005 USE <span class="keywordflow">IR_Precision</span>                                             <span class="comment">! Integers and reals precision definition.</span>
<a name="l00006"></a>00006 USE, <span class="keywordtype">intrinsic</span>:: ISO_FORTRAN_ENV, only: stderr =&gt; ERROR_UNIT <span class="comment">! Standard output/error logical units.</span>
<a name="l00007"></a><a class="code" href="../../d3/d18/classData__Type__BC.html">00007</a> <span class="preprocessor">#ifdef MPI2</span>
<a name="l00008"></a>00008 USE <span class="keywordflow">MPI</span>                                                      <span class="comment">! MPI runtime library.</span>
<a name="l00009"></a>00009 <span class="preprocessor">#endif</span>
<a name="l00010"></a>00010 <span class="comment">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="comment">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00013"></a>00013 <span class="keyword">implicit none</span>
<a name="l00014"></a>00014 <span class="keywordtype">private</span>
<a name="l00015"></a>00015 <span class="keywordtype">public</span>:: bc_nan_str,bc_nan
<a name="l00016"></a>00016 <span class="keywordtype">public</span>:: bc_ref_str,bc_ref
<a name="l00017"></a>00017 <span class="keywordtype">public</span>:: bc_ext_str,bc_ext
<a name="l00018"></a>00018 <span class="keywordtype">public</span>:: bc_per_str,bc_per
<a name="l00019"></a>00019 <span class="keywordtype">public</span>:: bc_adj_str,bc_adj
<a name="l00020"></a>00020 <span class="keywordtype">public</span>:: bc_in1_str,bc_in1
<a name="l00021"></a>00021 <span class="keywordtype">public</span>:: bc_in2_str,bc_in2
<a name="l00022"></a>00022 <span class="keywordtype">public</span>:: Nbc
<a name="l00023"></a>00023 <span class="keywordtype">public</span>:: bc_list,bc_list_str
<a name="l00024"></a>00024 <span class="keywordtype">public</span>:: init,set,get,<a class="code" href="../../db/da2/interfaceData__Type__BC_1_1free.html">free</a>
<a name="l00025"></a>00025 <span class="keywordtype">public</span>:: <span class="keyword">write</span>,<span class="keyword">read</span>
<a name="l00026"></a>00026 <span class="keywordtype">public</span>:: get_bc_id,get_bc_str
<a name="l00027"></a>00027 <span class="comment">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00030"></a>00030 <span class="comment">! Type id parameters</span>
<a name="l00031"></a>00031 <span class="keywordtype">character(3)</span>, <span class="keywordtype">parameter</span>:: bc_nan_str = <span class="stringliteral">&#39;NAN&#39;</span> <span class="comment">!&lt; Definition of non-assigned boundary condition parameter string.</span>
<a name="l00032"></a>00032 <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">parameter</span>:: bc_nan     =-1_I_P <span class="comment">!&lt; Definition of non-assigned boundary condition parameter id.</span>
<a name="l00033"></a>00033 <span class="keywordtype">character(3)</span>, <span class="keywordtype">parameter</span>:: bc_ref_str = <span class="stringliteral">&#39;REF&#39;</span> <span class="comment">!&lt; Definition of reflective boundary condition parameter string.</span>
<a name="l00034"></a>00034 <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">parameter</span>:: bc_ref     = 1_I_P <span class="comment">!&lt; Definition of reflective boundary condition parameter id.</span>
<a name="l00035"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#aba3d6c105c63b750f747ee2895ce5827">00035</a> <span class="keywordtype">character(3)</span>, <span class="keywordtype">parameter</span>:: bc_ext_str = <span class="stringliteral">&#39;EXT&#39;</span> <span class="comment">!&lt; Definition of extrapolation boundary condition parameter string.</span>
<a name="l00036"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a12705f5267b03a588216122f28a447ee">00036</a> <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">parameter</span>:: bc_ext     = 2_I_P <span class="comment">!&lt; Definition of extrapolation boundary condition parameter id.</span>
<a name="l00037"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a45f56899faf88976562f3cf270109df3">00037</a> <span class="keywordtype">character(3)</span>, <span class="keywordtype">parameter</span>:: bc_per_str = <span class="stringliteral">&#39;PER&#39;</span> <span class="comment">!&lt; Definition of periodic boundary condition parameter string.</span>
<a name="l00038"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a6e9571d7808fa4f959c685aa97a7193e">00038</a> <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">parameter</span>:: bc_per     = 3_I_P <span class="comment">!&lt; Definition of periodic boundary condition parameter id.</span>
<a name="l00039"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a71bccf03a41362cc3df8c83b173b4b4f">00039</a> <span class="keywordtype">character(3)</span>, <span class="keywordtype">parameter</span>:: bc_adj_str = <span class="stringliteral">&#39;ADJ&#39;</span> <span class="comment">!&lt; Definition of adjacent boundary condition parameter string.</span>
<a name="l00040"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a49fc7fabeb39c0fe1290823c5c377d52">00040</a> <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">parameter</span>:: bc_adj     = 4_I_P <span class="comment">!&lt; Definition of adjacent boundary condition parameter id.</span>
<a name="l00041"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a7689b9f99c19032da0b435e68971cb5d">00041</a> <span class="keywordtype">character(3)</span>, <span class="keywordtype">parameter</span>:: bc_in1_str = <span class="stringliteral">&#39;IN1&#39;</span> <span class="comment">!&lt; Definition of inflow 1 boundary condition parameter string.</span>
<a name="l00042"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a00b03db0a9908294de926a1dbcb0edfa">00042</a> <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">parameter</span>:: bc_in1     = 5_I_P <span class="comment">!&lt; Definition of inflow 1 boundary condition parameter id.</span>
<a name="l00043"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#ae5aaa28987e425cf32dceea7fdd1eb60">00043</a> <span class="keywordtype">character(3)</span>, <span class="keywordtype">parameter</span>:: bc_in2_str = <span class="stringliteral">&#39;IN2&#39;</span> <span class="comment">!&lt; Definition of inflow 2 boundary condition parameter string.</span>
<a name="l00044"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#af08bc0938997e15ec00462eef940b6be">00044</a> <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">parameter</span>:: bc_in2     = 6_I_P <span class="comment">!&lt; Definition of inflow 2 boundary condition parameter id.</span>
<a name="l00045"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a572b5c13aa01f00b87fb608e6d4cd529">00045</a> <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">parameter</span>:: Nbc = 7            <span class="comment">!&lt; Number of possible boundary conditions.</span>
<a name="l00046"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a25327ca52cc1d1c270974da772206044">00046</a> <span class="keywordtype">character(3)</span>, <span class="keywordtype">parameter</span>:: bc_list_str(1:Nbc) = 
<a name="l00047"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#ad379a24e475bf5bb4f7afc50cddc6b3c">00047</a>                                              (/ bc_nan_str, 
<a name="l00048"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a9cf4a2954cc4d04714f515000b073d2f">00048</a>                                                 bc_ref_str, 
<a name="l00049"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a08a8876e8d17361eac9749c84014d732">00049</a>                                                 bc_ext_str, 
<a name="l00050"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#acd4bad6563631537629e33f3bbb4b6cb">00050</a>                                                 bc_per_str, 
<a name="l00051"></a>00051                                                 bc_adj_str, 
<a name="l00052"></a>00052                                                 bc_in1_str, 
<a name="l00053"></a>00053                                                 bc_in2_str  
<a name="l00054"></a>00054                                               /) <span class="comment">!&lt; Boundary conditions string list.</span>
<a name="l00055"></a>00055 <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">parameter</span>:: bc_list    (1:Nbc) = 
<a name="l00056"></a>00056                                              (/ bc_nan, 
<a name="l00057"></a>00057                                                 bc_ref, 
<a name="l00058"></a>00058                                                 bc_ext, 
<a name="l00059"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#ae0cfebe6be97fc3bea31e11bc1cea223">00059</a>                                                 bc_per, 
<a name="l00060"></a>00060                                                 bc_adj, 
<a name="l00061"></a>00061                                                 bc_in1, 
<a name="l00062"></a>00062                                                 bc_in2  
<a name="l00063"></a>00063                                               /) <span class="comment">!&lt; Boundary conditions list.</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="keyword">type</span>, public:: <a class="code" href="../../d3/d18/classData__Type__BC.html#db/db0/structData__Type__BC_1_1Type__Adj">Type_Adj</a>
<a name="l00066"></a>00066   sequence
<a name="l00067"></a>00067   <span class="keywordtype">integer(I_P)</span>:: b = 0_I_P <span class="comment">!&lt; b index of adjacent block.</span>
<a name="l00068"></a>00068   <span class="keywordtype">integer(I_P)</span>:: i = 0_I_P <span class="comment">!&lt; i index of adjacent block.</span>
<a name="l00069"></a><a class="code" href="../../d3/d18/classData__Type__BC.html">00069</a>   <span class="keywordtype">integer(I_P)</span>:: j = 0_I_P <span class="comment">!&lt; j index of adjacent block.</span>
<a name="l00070"></a>00070   <span class="keywordtype">integer(I_P)</span>:: k = 0_I_P <span class="comment">!&lt; k index of adjacent block.</span>
<a name="l00071"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a6ea8b8b12b9331c3d5d1004072883dc9">00071</a> <span class="keyword">endtype Type_Adj</span>
<a name="l00079"></a>00079 <span class="keyword">type</span>, public:: <a class="code" href="../../d3/d18/classData__Type__BC.html#d2/dd8/structData__Type__BC_1_1Type__BC">Type_BC</a>
<a name="l00080"></a>00080   <span class="keywordtype">integer(I_P)</span>::                tp = bc_ext <span class="comment">!&lt; Type of boundary condition (bc_nan,bc_ref,bc_ext...).</span>
<a name="l00081"></a>00081   <span class="keywordtype">integer(I_P)</span>,   <span class="keywordtype">allocatable</span>:: inf         <span class="comment">!&lt; Auxiliary informations for inflow-type  boundary condition.</span>
<a name="l00082"></a>00082   <span class="keywordtype">type(Type_Adj)</span>, <span class="keywordtype">allocatable</span>:: adj         <span class="comment">!&lt; Connection indexes for adjacent boundary condition.</span>
<a name="l00083"></a><a class="code" href="../../d3/d18/classData__Type__BC.html">00083</a> <span class="keyword">endtype Type_BC</span>
<a name="l00084"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a46c5cebacba560f0b2faf1fbe26f5758">00084</a> <span class="comment">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00085"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a206a1729250d6ce1f3038d76670ae704">00085</a> 
<a name="l00086"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a70d56ac34bdc0cca13d82e15ef4837a5">00086</a> <span class="comment">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00100"></a>00100 <span class="keyword">interface</span> <a class="code" href="../../db/da2/interfaceData__Type__BC_1_1free.html">free</a>
<a name="l00101"></a>00101   <span class="keyword">module procedure</span> Free_Scalar,Free_Array1D,Free_Array2D,Free_Array3D
<a name="l00102"></a>00102 <span class="keyword">endinterface</span>
<a name="l00122"></a>00122 <span class="keyword">interface</span> <a class="code" href="../../dd/d85/interfaceData__Type__BC_1_1write.html">write</a>
<a name="l00123"></a>00123   <span class="keyword">module procedure</span> Write_Bin_Scalar,     Write_Ascii_Scalar
<a name="l00124"></a>00124   <span class="keyword">module procedure</span> Write_Bin_Array1D,Write_Ascii_Array1D
<a name="l00125"></a>00125   <span class="keyword">module procedure</span> Write_Bin_Array2D,Write_Ascii_Array2D
<a name="l00126"></a><a class="code" href="../../dd/d85/interfaceData__Type__BC_1_1write.html">00126</a>   <span class="keyword">module procedure</span> Write_Bin_Array3D,Write_Ascii_Array3D
<a name="l00127"></a>00127 <span class="keyword">endinterface</span>
<a name="l00147"></a>00147 <span class="keyword">interface</span> <a class="code" href="../../d8/d9f/interfaceData__Type__BC_1_1read.html">read</a>
<a name="l00148"></a>00148   <span class="keyword">module procedure</span> Read_Bin_Scalar,     Read_Ascii_Scalar
<a name="l00149"></a>00149   <span class="keyword">module procedure</span> Read_Bin_Array1D,Read_Ascii_Array1D
<a name="l00150"></a>00150   <span class="keyword">module procedure</span> Read_Bin_Array2D,Read_Ascii_Array2D
<a name="l00151"></a><a class="code" href="../../d8/d9f/interfaceData__Type__BC_1_1read.html">00151</a>   <span class="keyword">module procedure</span> Read_Bin_Array3D,Read_Ascii_Array3D
<a name="l00152"></a>00152 <span class="keyword">endinterface</span>
<a name="l00153"></a>00153 <span class="comment">!-----------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00154"></a>00154 <span class="keyword">contains</span>
<a name="l00157"></a>00157   <span class="keywordtype">elemental</span> <span class="keyword">function </span>init(tp,inf,adj) result(bc)
<a name="l00158"></a>00158   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00159"></a>00159   <span class="keyword">implicit none</span>
<a name="l00160"></a>00160   <span class="keywordtype">integer(I_P)</span>,   <span class="keywordtype">intent(IN)</span>, <span class="keywordtype">optional</span>:: tp  <span class="comment">!&lt; Type of boundary condition.</span>
<a name="l00161"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#af7b025b04c4ba85da6f3bd21cd8276f4">00161</a>   <span class="keywordtype">integer(I_P)</span>,   <span class="keywordtype">intent(IN)</span>, <span class="keywordtype">optional</span>:: inf <span class="comment">!&lt; Auxiliary informations for inflow-type  boundary condition.</span>
<a name="l00162"></a>00162   <span class="keywordtype">type(Type_Adj)</span>, <span class="keywordtype">intent(IN)</span>, <span class="keywordtype">optional</span>:: adj <span class="comment">!&lt; Connection indexes for adjacent boundary condition.</span>
<a name="l00163"></a>00163   <span class="keywordtype">type(Type_BC)</span>::                        bc  <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00164"></a>00164   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00167"></a>00167   <span class="keyword">if</span> (present(tp))  call set(tp  = tp,  bc = bc)
<a name="l00168"></a>00168   <span class="keyword">if</span> (present(inf)) call set(inf = inf, bc = bc)
<a name="l00169"></a>00169   <span class="keyword">if</span> (present(adj)) call set(adj = adj, bc = bc)
<a name="l00170"></a>00170   return
<a name="l00171"></a>00171   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00172"></a>00172 <span class="keyword">  endfunction init</span>
<a name="l00173"></a>00173 
<a name="l00176"></a>00176   <span class="keywordtype">elemental</span> <span class="keyword">subroutine </span>set(tp,inf,adj,bc) !result(bc)
<a name="l00177"></a>00177   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00178"></a>00178   <span class="keyword">implicit none</span>
<a name="l00179"></a>00179   <span class="keywordtype">integer(I_P)</span>,   <span class="keywordtype">intent(IN)</span>, <span class="keywordtype">optional</span>:: tp  <span class="comment">!&lt; Type of boundary condition.</span>
<a name="l00180"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a1d324c97e209dc1442ecad2ce626d220">00180</a>   <span class="keywordtype">integer(I_P)</span>,   <span class="keywordtype">intent(IN)</span>, <span class="keywordtype">optional</span>:: inf <span class="comment">!&lt; Auxiliary informations for inflow-type  boundary condition.</span>
<a name="l00181"></a>00181   <span class="keywordtype">type(Type_Adj)</span>, <span class="keywordtype">intent(IN)</span>, <span class="keywordtype">optional</span>:: adj <span class="comment">!&lt; Connection indexes for adjacent boundary condition.</span>
<a name="l00182"></a>00182   <span class="keywordtype">type(Type_BC)</span>,  <span class="keywordtype">intent(INOUT)</span>::        bc  <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00183"></a>00183   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00184"></a>00184 
<a name="l00185"></a>00185   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00186"></a>00186   <span class="keyword">if</span> (present(tp))  bc%tp  = tp
<a name="l00187"></a>00187   <span class="keyword">if</span> (present(inf)) <span class="keyword">then</span>
<a name="l00188"></a>00188    <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc%inf)) <span class="keyword">deallocate</span>(bc%inf) ; <span class="keyword">allocate</span>(bc%inf) ; bc%inf = inf
<a name="l00189"></a>00189   <span class="keyword">endif</span>
<a name="l00190"></a>00190   <span class="keyword">if</span> (present(adj)) <span class="keyword">then</span>
<a name="l00191"></a>00191    <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc%adj)) <span class="keyword">deallocate</span>(bc%adj) ; <span class="keyword">allocate</span>(bc%adj) ; bc%adj = adj
<a name="l00192"></a>00192   <span class="keyword">endif</span>
<a name="l00193"></a>00193   return
<a name="l00194"></a>00194   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00195"></a>00195 <span class="keyword">  endsubroutine set</span>
<a name="l00196"></a>00196 
<a name="l00198"></a>00198   <span class="keywordtype">elemental</span> <span class="keyword">subroutine </span>get(tp,inf,adj,bc)
<a name="l00199"></a>00199   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00200"></a>00200   <span class="keyword">implicit none</span>
<a name="l00201"></a>00201   <span class="keywordtype">integer(I_P)</span>,   <span class="keywordtype">intent(OUT)</span>, <span class="keywordtype">optional</span>:: tp  <span class="comment">!&lt; Type of boundary condition.</span>
<a name="l00202"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a87864bd245ce532e94ae8900f7012880">00202</a>   <span class="keywordtype">integer(I_P)</span>,   <span class="keywordtype">intent(OUT)</span>, <span class="keywordtype">optional</span>:: inf <span class="comment">!&lt; Auxiliary informations for inflow-type  boundary condition.</span>
<a name="l00203"></a>00203   <span class="keywordtype">type(Type_Adj)</span>, <span class="keywordtype">intent(OUT)</span>, <span class="keywordtype">optional</span>:: adj <span class="comment">!&lt; Connection indexes for adjacent boundary condition.</span>
<a name="l00204"></a>00204   <span class="keywordtype">type(Type_BC)</span>,  <span class="keywordtype">intent(IN)</span>::            bc  <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00205"></a>00205   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00206"></a>00206 
<a name="l00207"></a>00207   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00208"></a>00208   <span class="keyword">if</span> (present(tp )) tp  = bc%tp
<a name="l00209"></a>00209   <span class="keyword">if</span> (present(inf)) inf = bc%inf
<a name="l00210"></a>00210   <span class="keyword">if</span> (present(adj)) adj = bc%adj
<a name="l00211"></a>00211   return
<a name="l00212"></a>00212   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00213"></a>00213 <span class="keyword">  endsubroutine get</span>
<a name="l00214"></a>00214 
<a name="l00215"></a>00215   <span class="comment">! free dynamic memory</span>
<a name="l00218"></a>00218   <span class="keyword">function </span>Free_Scalar(bc) result(err)
<a name="l00219"></a>00219   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00220"></a>00220   <span class="keyword">implicit none</span>
<a name="l00221"></a>00221   <span class="keywordtype">type(Type_BC)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc  <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00222"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a7ec49d46c40fcee0653948078cbacc8c">00222</a>   <span class="keywordtype">integer(I4P)</span>::                 err <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00223"></a>00223   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00224"></a>00224 
<a name="l00225"></a>00225   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00226"></a>00226   err = 0_I4P
<a name="l00227"></a>00227   <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc%inf)) <span class="keyword">deallocate</span>(bc%inf,stat=err)
<a name="l00228"></a>00228   <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc%adj)) <span class="keyword">deallocate</span>(bc%adj,stat=err)
<a name="l00229"></a>00229   return
<a name="l00230"></a>00230   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00231"></a>00231 <span class="keyword">  endfunction Free_Scalar</span>
<a name="l00232"></a>00232 
<a name="l00235"></a>00235   <span class="keyword">function </span>Free_Array1D(bc) result(err)
<a name="l00236"></a>00236   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00237"></a>00237   <span class="keyword">implicit none</span>
<a name="l00238"></a>00238   <span class="keywordtype">type(Type_BC)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc(:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00239"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#ae91585aa55bf0882123320c74cb0bad3">00239</a>   <span class="keywordtype">integer(I4P)</span>::                 err   <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00240"></a>00240   <span class="keywordtype">integer(I4P)</span>::                 i     <span class="comment">!&lt; Counter.</span>
<a name="l00241"></a>00241   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00242"></a>00242 
<a name="l00243"></a>00243   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00244"></a>00244   err = 0_I4P
<a name="l00245"></a>00245   <span class="keyword">do</span> i=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00246"></a>00246     <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(i)%inf)) <span class="keyword">deallocate</span>(bc(i)%inf,stat=err)
<a name="l00247"></a>00247     <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(i)%adj)) <span class="keyword">deallocate</span>(bc(i)%adj,stat=err)
<a name="l00248"></a>00248   <span class="keyword">enddo</span>
<a name="l00249"></a>00249   return
<a name="l00250"></a>00250   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00251"></a>00251 <span class="keyword">  endfunction Free_Array1D</span>
<a name="l00252"></a>00252 
<a name="l00255"></a>00255   <span class="keyword">function </span>Free_Array2D(bc) result(err)
<a name="l00256"></a>00256   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00257"></a>00257   <span class="keyword">implicit none</span>
<a name="l00258"></a>00258   <span class="keywordtype">type(Type_BC)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc(:,:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00259"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a2c079a6b1c131d0293590831ec7aa6b4">00259</a>   <span class="keywordtype">integer(I4P)</span>::                 err     <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00260"></a>00260   <span class="keywordtype">integer(I4P)</span>::                 i,j     <span class="comment">!&lt; Counters.</span>
<a name="l00261"></a>00261   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00262"></a>00262 
<a name="l00263"></a>00263   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00264"></a>00264   err = 0_I4P
<a name="l00265"></a>00265   <span class="keyword">do</span> j=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00266"></a>00266     <span class="keyword">do</span> i=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00267"></a>00267       <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(i,j)%inf)) <span class="keyword">deallocate</span>(bc(i,j)%inf,stat=err)
<a name="l00268"></a>00268       <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(i,j)%adj)) <span class="keyword">deallocate</span>(bc(i,j)%adj,stat=err)
<a name="l00269"></a>00269     <span class="keyword">enddo</span>
<a name="l00270"></a>00270   <span class="keyword">enddo</span>
<a name="l00271"></a>00271   return
<a name="l00272"></a>00272   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00273"></a>00273 <span class="keyword">  endfunction Free_Array2D</span>
<a name="l00274"></a>00274 
<a name="l00277"></a>00277   <span class="keyword">function </span>Free_Array3D(bc) result(err)
<a name="l00278"></a>00278   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00279"></a>00279   <span class="keyword">implicit none</span>
<a name="l00280"></a>00280   <span class="keywordtype">type(Type_BC)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc(:,:,:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00281"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#ab5bcf43859f908e4e8b3a8f1c7978fd8">00281</a>   <span class="keywordtype">integer(I4P)</span>::                 err       <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00282"></a>00282   <span class="keywordtype">integer(I4P)</span>::                 i,j,k     <span class="comment">!&lt; Counters.</span>
<a name="l00283"></a>00283   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00284"></a>00284 
<a name="l00285"></a>00285   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00286"></a>00286   err = 0_I4P
<a name="l00287"></a>00287   <span class="keyword">do</span> k=lbound(bc,dim=3),ubound(bc,dim=3)
<a name="l00288"></a>00288     <span class="keyword">do</span> j=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00289"></a>00289       <span class="keyword">do</span> i=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00290"></a>00290         <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(i,j,k)%inf)) <span class="keyword">deallocate</span>(bc(i,j,k)%inf,stat=err)
<a name="l00291"></a>00291         <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(i,j,k)%adj)) <span class="keyword">deallocate</span>(bc(i,j,k)%adj,stat=err)
<a name="l00292"></a>00292       <span class="keyword">enddo</span>
<a name="l00293"></a>00293     <span class="keyword">enddo</span>
<a name="l00294"></a>00294   <span class="keyword">enddo</span>
<a name="l00295"></a>00295   return
<a name="l00296"></a>00296   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00297"></a>00297 <span class="keyword">  endfunction Free_Array3D</span>
<a name="l00298"></a>00298 
<a name="l00299"></a>00299   <span class="comment">! write</span>
<a name="l00302"></a>00302   <span class="keyword">function </span>Write_Bin_Scalar(unit,bc) result(err)
<a name="l00303"></a>00303   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00304"></a>00304   <span class="keyword">implicit none</span>
<a name="l00305"></a>00305   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>:: unit  <span class="comment">!&lt; Logic unit.</span>
<a name="l00306"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#ad8c3dcb5f9dbc6bdce3f99ae89a070c5">00306</a>   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(IN)</span>:: bc    <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00307"></a>00307   <span class="keywordtype">integer(I_P)</span>::              err   <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00308"></a>00308   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00309"></a>00309 
<a name="l00310"></a>00310   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00311"></a>00311   <span class="keyword">write</span>(unit,iostat=err) bc%tp
<a name="l00312"></a>00312   <span class="keyword">select</span> <span class="keyword">case</span>(bc%tp)
<a name="l00313"></a>00313   <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00314"></a>00314     <span class="keyword">write</span>(unit,iostat=err)bc%inf
<a name="l00315"></a>00315   <span class="keyword">case</span>(bc_adj)
<a name="l00316"></a>00316     <span class="keyword">write</span>(unit,iostat=err)bc%adj
<a name="l00317"></a>00317   endselect
<a name="l00318"></a>00318   return
<a name="l00319"></a>00319   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00320"></a>00320 <span class="keyword">  endfunction Write_Bin_Scalar</span>
<a name="l00321"></a>00321 
<a name="l00324"></a>00324   <span class="keyword">function </span>Write_Ascii_Scalar(unit,format,bc) result(err)
<a name="l00325"></a>00325   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00326"></a>00326   <span class="keyword">implicit none</span>
<a name="l00327"></a>00327   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>:: unit   <span class="comment">!&lt; Logic unit.</span>
<a name="l00328"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a2ad8f249fed73ecfffce17b007dfbe30">00328</a>   <span class="keywordtype">character(*)</span>,  <span class="keywordtype">intent(IN)</span>:: format <span class="comment">!&lt; Format specifier.</span>
<a name="l00329"></a>00329   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(IN)</span>:: bc     <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00330"></a>00330   <span class="keywordtype">integer(I_P)</span>::              err    <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00331"></a>00331   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00332"></a>00332 
<a name="l00333"></a>00333   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00334"></a>00334   <span class="keyword">select</span> <span class="keyword">case</span>(adjustl(trim(format)))
<a name="l00335"></a>00335   <span class="keyword">case</span>(<span class="stringliteral">&#39;*&#39;</span>)
<a name="l00336"></a>00336     <span class="keyword">write</span>(unit,*,iostat=err) bc%tp
<a name="l00337"></a>00337     <span class="keyword">select</span> <span class="keyword">case</span>(bc%tp)
<a name="l00338"></a>00338     <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00339"></a>00339       <span class="keyword">write</span>(unit,*,iostat=err)bc%inf
<a name="l00340"></a>00340     <span class="keyword">case</span>(bc_adj)
<a name="l00341"></a>00341       <span class="keyword">write</span>(unit,*,iostat=err)bc%adj
<a name="l00342"></a>00342     endselect
<a name="l00343"></a>00343   <span class="keyword">case</span> default
<a name="l00344"></a>00344     <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err) bc%tp
<a name="l00345"></a>00345     <span class="keyword">select</span> <span class="keyword">case</span>(bc%tp)
<a name="l00346"></a>00346     <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00347"></a>00347       <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc%inf
<a name="l00348"></a>00348     <span class="keyword">case</span>(bc_adj)
<a name="l00349"></a>00349       <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc%adj
<a name="l00350"></a>00350     endselect
<a name="l00351"></a>00351   endselect
<a name="l00352"></a>00352   return
<a name="l00353"></a>00353   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00354"></a>00354 <span class="keyword">  endfunction Write_Ascii_Scalar</span>
<a name="l00355"></a>00355 
<a name="l00358"></a>00358   <span class="keyword">function </span>Write_Bin_Array1D(unit,bc) result(err)
<a name="l00359"></a>00359   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00360"></a>00360   <span class="keyword">implicit none</span>
<a name="l00361"></a>00361   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>:: unit  <span class="comment">!&lt; Logic unit.</span>
<a name="l00362"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#ae2bcb20f85ddb45871c67ddc79bc831a">00362</a>   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(IN)</span>:: bc(:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00363"></a>00363   <span class="keywordtype">integer(I_P)</span>::              err   <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00364"></a>00364   <span class="keywordtype">integer(I_P)</span>::              n     <span class="comment">!&lt; Counter.</span>
<a name="l00365"></a>00365   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00366"></a>00366 
<a name="l00367"></a>00367   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00368"></a>00368   <span class="keyword">write</span>(unit,iostat=err)bc%tp
<a name="l00369"></a>00369   <span class="keyword">do</span> n=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00370"></a>00370     <span class="keyword">select</span> <span class="keyword">case</span>(bc(n)%tp)
<a name="l00371"></a>00371     <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00372"></a>00372       <span class="keyword">write</span>(unit,iostat=err)bc(n)%inf
<a name="l00373"></a>00373     <span class="keyword">case</span>(bc_adj)
<a name="l00374"></a>00374       <span class="keyword">write</span>(unit,iostat=err)bc(n)%adj
<a name="l00375"></a>00375     endselect
<a name="l00376"></a>00376   <span class="keyword">enddo</span>
<a name="l00377"></a>00377   return
<a name="l00378"></a>00378   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00379"></a>00379 <span class="keyword">  endfunction Write_Bin_Array1D</span>
<a name="l00380"></a>00380 
<a name="l00383"></a>00383   <span class="keyword">function </span>Write_Ascii_Array1D(unit,format,bc) result(err)
<a name="l00384"></a>00384   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00385"></a>00385   <span class="keyword">implicit none</span>
<a name="l00386"></a>00386   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>:: unit   <span class="comment">!&lt; Logic unit.</span>
<a name="l00387"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#aff1b8c4261792eb5e552bda14ad7617b">00387</a>   <span class="keywordtype">character(*)</span>,  <span class="keywordtype">intent(IN)</span>:: format <span class="comment">!&lt; Format specifier.</span>
<a name="l00388"></a>00388   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(IN)</span>:: bc(:)  <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00389"></a>00389   <span class="keywordtype">integer(I_P)</span>::              err    <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00390"></a>00390   <span class="keywordtype">integer(I_P)</span>::              n      <span class="comment">!&lt; Counter.</span>
<a name="l00391"></a>00391   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00392"></a>00392 
<a name="l00393"></a>00393   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00394"></a>00394   <span class="keyword">select</span> <span class="keyword">case</span>(adjustl(trim(format)))
<a name="l00395"></a>00395   <span class="keyword">case</span>(<span class="stringliteral">&#39;*&#39;</span>)
<a name="l00396"></a>00396     <span class="keyword">write</span>(unit,*,iostat=err)bc%tp
<a name="l00397"></a>00397     <span class="keyword">do</span> n=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00398"></a>00398       <span class="keyword">select</span> <span class="keyword">case</span>(bc(n)%tp)
<a name="l00399"></a>00399       <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00400"></a>00400         <span class="keyword">write</span>(unit,*,iostat=err)bc(n)%inf
<a name="l00401"></a>00401       <span class="keyword">case</span>(bc_adj)
<a name="l00402"></a>00402         <span class="keyword">write</span>(unit,*,iostat=err)bc(n)%adj
<a name="l00403"></a>00403       endselect
<a name="l00404"></a>00404     <span class="keyword">enddo</span>
<a name="l00405"></a>00405   <span class="keyword">case</span> default
<a name="l00406"></a>00406     <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc%tp
<a name="l00407"></a>00407     <span class="keyword">do</span> n=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00408"></a>00408       <span class="keyword">select</span> <span class="keyword">case</span>(bc(n)%tp)
<a name="l00409"></a>00409       <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00410"></a>00410         <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc(n)%inf
<a name="l00411"></a>00411       <span class="keyword">case</span>(bc_adj)
<a name="l00412"></a>00412         <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc(n)%adj
<a name="l00413"></a>00413       endselect
<a name="l00414"></a>00414     <span class="keyword">enddo</span>
<a name="l00415"></a>00415   endselect
<a name="l00416"></a>00416   return
<a name="l00417"></a>00417   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00418"></a>00418 <span class="keyword">  endfunction Write_Ascii_Array1D</span>
<a name="l00419"></a>00419 
<a name="l00422"></a>00422   <span class="keyword">function </span>Write_Bin_Array2D(unit,bc) result(err)
<a name="l00423"></a>00423   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00424"></a>00424   <span class="keyword">implicit none</span>
<a name="l00425"></a>00425   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>:: unit    <span class="comment">!&lt; Logic unit.</span>
<a name="l00426"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#aa5c0fc218862752c5b2f19da4e1af7a9">00426</a>   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(IN)</span>:: bc(:,:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00427"></a>00427   <span class="keywordtype">integer(I_P)</span>::              err     <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00428"></a>00428   <span class="keywordtype">integer(I_P)</span>::              n1,n2   <span class="comment">!&lt; Counters.</span>
<a name="l00429"></a>00429   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00430"></a>00430 
<a name="l00431"></a>00431   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00432"></a>00432   <span class="keyword">write</span>(unit,iostat=err)bc%tp
<a name="l00433"></a>00433   <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00434"></a>00434     <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00435"></a>00435       <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2)%tp)
<a name="l00436"></a>00436       <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00437"></a>00437         <span class="keyword">write</span>(unit,iostat=err)bc(n1,n2)%inf
<a name="l00438"></a>00438       <span class="keyword">case</span>(bc_adj)
<a name="l00439"></a>00439         <span class="keyword">write</span>(unit,iostat=err)bc(n1,n2)%adj
<a name="l00440"></a>00440       endselect
<a name="l00441"></a>00441     <span class="keyword">enddo</span>
<a name="l00442"></a>00442   <span class="keyword">enddo</span>
<a name="l00443"></a>00443   return
<a name="l00444"></a>00444   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00445"></a>00445 <span class="keyword">  endfunction Write_Bin_Array2D</span>
<a name="l00446"></a>00446 
<a name="l00449"></a>00449   <span class="keyword">function </span>Write_Ascii_Array2D(unit,format,bc) result(err)
<a name="l00450"></a>00450   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00451"></a>00451   <span class="keyword">implicit none</span>
<a name="l00452"></a>00452   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>:: unit    <span class="comment">!&lt; Logic unit.</span>
<a name="l00453"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a6f20009cd29f2547a4307b67f766a529">00453</a>   <span class="keywordtype">character(*)</span>,  <span class="keywordtype">intent(IN)</span>:: format  <span class="comment">!&lt; Format specifier.</span>
<a name="l00454"></a>00454   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(IN)</span>:: bc(:,:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00455"></a>00455   <span class="keywordtype">integer(I_P)</span>::              err     <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00456"></a>00456   <span class="keywordtype">integer(I_P)</span>::              n1,n2   <span class="comment">!&lt; Counters.</span>
<a name="l00457"></a>00457   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00458"></a>00458 
<a name="l00459"></a>00459   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00460"></a>00460   <span class="keyword">select</span> <span class="keyword">case</span>(adjustl(trim(format)))
<a name="l00461"></a>00461   <span class="keyword">case</span>(<span class="stringliteral">&#39;*&#39;</span>)
<a name="l00462"></a>00462     <span class="keyword">write</span>(unit,*,iostat=err)bc%tp
<a name="l00463"></a>00463     <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00464"></a>00464       <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00465"></a>00465         <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2)%tp)
<a name="l00466"></a>00466         <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00467"></a>00467           <span class="keyword">write</span>(unit,*,iostat=err)bc(n1,n2)%inf
<a name="l00468"></a>00468         <span class="keyword">case</span>(bc_adj)
<a name="l00469"></a>00469           <span class="keyword">write</span>(unit,*,iostat=err)bc(n1,n2)%adj
<a name="l00470"></a>00470         endselect
<a name="l00471"></a>00471       <span class="keyword">enddo</span>
<a name="l00472"></a>00472     <span class="keyword">enddo</span>
<a name="l00473"></a>00473   <span class="keyword">case</span> default
<a name="l00474"></a>00474     <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc%tp
<a name="l00475"></a>00475     <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00476"></a>00476       <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00477"></a>00477         <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2)%tp)
<a name="l00478"></a>00478         <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00479"></a>00479           <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc(n1,n2)%inf
<a name="l00480"></a>00480         <span class="keyword">case</span>(bc_adj)
<a name="l00481"></a>00481           <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc(n1,n2)%adj
<a name="l00482"></a>00482         endselect
<a name="l00483"></a>00483       <span class="keyword">enddo</span>
<a name="l00484"></a>00484     <span class="keyword">enddo</span>
<a name="l00485"></a>00485   endselect
<a name="l00486"></a>00486   return
<a name="l00487"></a>00487   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00488"></a>00488 <span class="keyword">  endfunction Write_Ascii_Array2D</span>
<a name="l00489"></a>00489 
<a name="l00492"></a>00492   <span class="keyword">function </span>Write_Bin_Array3D(unit,bc) result(err)
<a name="l00493"></a>00493   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00494"></a>00494   <span class="keyword">implicit none</span>
<a name="l00495"></a>00495   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>:: unit      <span class="comment">!&lt; Logic unit.</span>
<a name="l00496"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a36270cee28859aa1908c7c5e61440f3b">00496</a>   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(IN)</span>:: bc(:,:,:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00497"></a>00497   <span class="keywordtype">integer(I_P)</span>::              err       <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00498"></a>00498   <span class="keywordtype">integer(I_P)</span>::              n1,n2,n3  <span class="comment">!&lt; Counters.</span>
<a name="l00499"></a>00499   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00500"></a>00500 
<a name="l00501"></a>00501   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00502"></a>00502   <span class="keyword">write</span>(unit,iostat=err)bc%tp
<a name="l00503"></a>00503   <span class="keyword">do</span> n3=lbound(bc,dim=3),ubound(bc,dim=3)
<a name="l00504"></a>00504     <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00505"></a>00505       <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00506"></a>00506         <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2,n3)%tp)
<a name="l00507"></a>00507         <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00508"></a>00508           <span class="keyword">write</span>(unit,iostat=err)bc(n1,n2,n3)%inf
<a name="l00509"></a>00509         <span class="keyword">case</span>(bc_adj)
<a name="l00510"></a>00510           <span class="keyword">write</span>(unit,iostat=err)bc(n1,n2,n3)%adj
<a name="l00511"></a>00511         endselect
<a name="l00512"></a>00512       <span class="keyword">enddo</span>
<a name="l00513"></a>00513     <span class="keyword">enddo</span>
<a name="l00514"></a>00514   <span class="keyword">enddo</span>
<a name="l00515"></a>00515   return
<a name="l00516"></a>00516   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00517"></a>00517 <span class="keyword">  endfunction Write_Bin_Array3D</span>
<a name="l00518"></a>00518 
<a name="l00521"></a>00521   <span class="keyword">function </span>Write_Ascii_Array3D(unit,format,bc) result(err)
<a name="l00522"></a>00522   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00523"></a>00523   <span class="keyword">implicit none</span>
<a name="l00524"></a>00524   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>:: unit      <span class="comment">!&lt; Logic unit.</span>
<a name="l00525"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#abdd4bf61913c2ade5e36fe2a4453dac1">00525</a>   <span class="keywordtype">character(*)</span>,  <span class="keywordtype">intent(IN)</span>:: format    <span class="comment">!&lt; Format specifier.</span>
<a name="l00526"></a>00526   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(IN)</span>:: bc(:,:,:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00527"></a>00527   <span class="keywordtype">integer(I_P)</span>::              err       <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00528"></a>00528   <span class="keywordtype">integer(I_P)</span>::              n1,n2,n3  <span class="comment">!&lt; Counters.</span>
<a name="l00529"></a>00529   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00530"></a>00530 
<a name="l00531"></a>00531   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00532"></a>00532   <span class="keyword">select</span> <span class="keyword">case</span>(adjustl(trim(format)))
<a name="l00533"></a>00533   <span class="keyword">case</span>(<span class="stringliteral">&#39;*&#39;</span>)
<a name="l00534"></a>00534     <span class="keyword">write</span>(unit,*,iostat=err)bc%tp
<a name="l00535"></a>00535     <span class="keyword">do</span> n3=lbound(bc,dim=3),ubound(bc,dim=3)
<a name="l00536"></a>00536       <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00537"></a>00537         <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00538"></a>00538           <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2,n3)%tp)
<a name="l00539"></a>00539           <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00540"></a>00540             <span class="keyword">write</span>(unit,*,iostat=err)bc(n1,n2,n3)%inf
<a name="l00541"></a>00541           <span class="keyword">case</span>(bc_adj)
<a name="l00542"></a>00542             <span class="keyword">write</span>(unit,*,iostat=err)bc(n1,n2,n3)%adj
<a name="l00543"></a>00543           endselect
<a name="l00544"></a>00544         <span class="keyword">enddo</span>
<a name="l00545"></a>00545       <span class="keyword">enddo</span>
<a name="l00546"></a>00546     <span class="keyword">enddo</span>
<a name="l00547"></a>00547   <span class="keyword">case</span> default
<a name="l00548"></a>00548     <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc%tp
<a name="l00549"></a>00549     <span class="keyword">do</span> n3=lbound(bc,dim=3),ubound(bc,dim=3)
<a name="l00550"></a>00550       <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00551"></a>00551         <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00552"></a>00552           <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2,n3)%tp)
<a name="l00553"></a>00553           <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00554"></a>00554             <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc(n1,n2,n3)%inf
<a name="l00555"></a>00555           <span class="keyword">case</span>(bc_adj)
<a name="l00556"></a>00556             <span class="keyword">write</span>(unit,adjustl(trim(format)),iostat=err)bc(n1,n2,n3)%adj
<a name="l00557"></a>00557           endselect
<a name="l00558"></a>00558         <span class="keyword">enddo</span>
<a name="l00559"></a>00559       <span class="keyword">enddo</span>
<a name="l00560"></a>00560     <span class="keyword">enddo</span>
<a name="l00561"></a>00561   endselect
<a name="l00562"></a>00562   return
<a name="l00563"></a>00563   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00564"></a>00564 <span class="keyword">  endfunction Write_Ascii_Array3D</span>
<a name="l00565"></a>00565 
<a name="l00566"></a>00566   <span class="comment">! read</span>
<a name="l00569"></a>00569   <span class="keyword">function </span>Read_Bin_Scalar(unit,bc) result(err)
<a name="l00570"></a>00570   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00571"></a>00571   <span class="keyword">implicit none</span>
<a name="l00572"></a>00572   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>::    unit  <span class="comment">!&lt; Logic unit.</span>
<a name="l00573"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a4a2280f67f1e66093fbbc6e01a405245">00573</a>   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc    <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00574"></a>00574   <span class="keywordtype">integer(I_P)</span>::                 err   <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00575"></a>00575   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00578"></a>00578   <span class="keyword">read</span>(unit,iostat=err)bc%tp
<a name="l00579"></a>00579   <span class="keyword">select</span> <span class="keyword">case</span>(bc%tp)
<a name="l00580"></a>00580   <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00581"></a>00581     <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc%inf)) <span class="keyword">deallocate</span>(bc%inf) ; <span class="keyword">allocate</span>(bc%inf) ; <span class="keyword">read</span>(unit,iostat=err)bc%inf
<a name="l00582"></a>00582   <span class="keyword">case</span>(bc_adj)
<a name="l00583"></a>00583     <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc%adj)) <span class="keyword">deallocate</span>(bc%adj) ; <span class="keyword">allocate</span>(bc%adj) ; <span class="keyword">read</span>(unit,iostat=err)bc%adj
<a name="l00584"></a>00584   endselect
<a name="l00585"></a>00585   return
<a name="l00586"></a>00586   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00587"></a>00587 <span class="keyword">  endfunction Read_Bin_Scalar</span>
<a name="l00588"></a>00588 
<a name="l00591"></a>00591   <span class="keyword">function </span>Read_Ascii_Scalar(unit,format,bc) result(err)
<a name="l00592"></a>00592   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00593"></a>00593   <span class="keyword">implicit none</span>
<a name="l00594"></a>00594   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>::    unit   <span class="comment">!&lt; Logic unit.</span>
<a name="l00595"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#aa72e0cc3d0423673cb6ed57288f592f9">00595</a>   <span class="keywordtype">character(*)</span>,  <span class="keywordtype">intent(IN)</span>::    format <span class="comment">!&lt; Format specifier.</span>
<a name="l00596"></a>00596   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc     <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00597"></a>00597   <span class="keywordtype">integer(I_P)</span>::                 err    <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00598"></a>00598   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00599"></a>00599 
<a name="l00600"></a>00600   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00601"></a>00601   <span class="keyword">select</span> <span class="keyword">case</span>(adjustl(trim(format)))
<a name="l00602"></a>00602   <span class="keyword">case</span>(<span class="stringliteral">&#39;*&#39;</span>)
<a name="l00603"></a>00603     <span class="keyword">read</span>(unit,*,iostat=err)bc%tp
<a name="l00604"></a>00604     <span class="keyword">select</span> <span class="keyword">case</span>(bc%tp)
<a name="l00605"></a>00605     <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00606"></a>00606       <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc%inf)) <span class="keyword">deallocate</span>(bc%inf) ; <span class="keyword">allocate</span>(bc%inf) ; <span class="keyword">read</span>(unit,*,iostat=err)bc%inf
<a name="l00607"></a>00607     <span class="keyword">case</span>(bc_adj)
<a name="l00608"></a>00608       <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc%adj)) <span class="keyword">deallocate</span>(bc%adj) ; <span class="keyword">allocate</span>(bc%adj) ; <span class="keyword">read</span>(unit,*,iostat=err)bc%adj
<a name="l00609"></a>00609     endselect
<a name="l00610"></a>00610   <span class="keyword">case</span> default
<a name="l00611"></a>00611     <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err) bc%tp
<a name="l00612"></a>00612     <span class="keyword">select</span> <span class="keyword">case</span>(bc%tp)
<a name="l00613"></a>00613     <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00614"></a>00614       <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc%inf)) <span class="keyword">deallocate</span>(bc%inf) ; <span class="keyword">allocate</span>(bc%inf) ; <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc%inf
<a name="l00615"></a>00615     <span class="keyword">case</span>(bc_adj)
<a name="l00616"></a>00616       <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc%adj)) <span class="keyword">deallocate</span>(bc%adj) ; <span class="keyword">allocate</span>(bc%adj) ; <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc%adj
<a name="l00617"></a>00617     endselect
<a name="l00618"></a>00618   endselect
<a name="l00619"></a>00619   return
<a name="l00620"></a>00620   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00621"></a>00621 <span class="keyword">  endfunction Read_Ascii_Scalar</span>
<a name="l00622"></a>00622 
<a name="l00625"></a>00625   <span class="keyword">function </span>Read_Bin_Array1D(unit,bc) result(err)
<a name="l00626"></a>00626   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00627"></a>00627   <span class="keyword">implicit none</span>
<a name="l00628"></a>00628   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>::    unit  <span class="comment">!&lt; Logic unit.</span>
<a name="l00629"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#aac395ec31900058cb43dbb7b54b61edd">00629</a>   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc(:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00630"></a>00630   <span class="keywordtype">integer(I_P)</span>::                 err   <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00631"></a>00631   <span class="keywordtype">integer(I_P)</span>::                 n     <span class="comment">!&lt; Counter.</span>
<a name="l00632"></a>00632   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00633"></a>00633 
<a name="l00634"></a>00634   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00635"></a>00635   <span class="keyword">read</span>(unit,iostat=err)bc%tp
<a name="l00636"></a>00636   <span class="keyword">do</span> n=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00637"></a>00637     <span class="keyword">select</span> <span class="keyword">case</span>(bc(n)%tp)
<a name="l00638"></a>00638     <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00639"></a>00639       <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n)%inf)) <span class="keyword">deallocate</span>(bc(n)%inf) ; <span class="keyword">allocate</span>(bc(n)%inf) ; <span class="keyword">read</span>(unit,iostat=err)bc(n)%inf
<a name="l00640"></a>00640     <span class="keyword">case</span>(bc_adj)
<a name="l00641"></a>00641       <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n)%adj)) <span class="keyword">deallocate</span>(bc(n)%adj) ; <span class="keyword">allocate</span>(bc(n)%adj) ; <span class="keyword">read</span>(unit,iostat=err)bc(n)%adj
<a name="l00642"></a>00642     endselect
<a name="l00643"></a>00643   <span class="keyword">enddo</span>
<a name="l00644"></a>00644   return
<a name="l00645"></a>00645   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00646"></a>00646 <span class="keyword">  endfunction Read_Bin_Array1D</span>
<a name="l00647"></a>00647 
<a name="l00650"></a>00650   <span class="keyword">function </span>Read_Ascii_Array1D(unit,format,bc) result(err)
<a name="l00651"></a>00651   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00652"></a>00652   <span class="keyword">implicit none</span>
<a name="l00653"></a>00653   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>::    unit   <span class="comment">!&lt; Logic unit.</span>
<a name="l00654"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#afe8970e1f11efe9e5ed0944d75f7d2a1">00654</a>   <span class="keywordtype">character(*)</span>,  <span class="keywordtype">intent(IN)</span>::    format <span class="comment">!&lt; Format specifier.</span>
<a name="l00655"></a>00655   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc(:)  <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00656"></a>00656   <span class="keywordtype">integer(I_P)</span>::                 err    <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00657"></a>00657   <span class="keywordtype">integer(I_P)</span>::                 n      <span class="comment">!&lt; Counter.</span>
<a name="l00658"></a>00658   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00659"></a>00659 
<a name="l00660"></a>00660   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00661"></a>00661   <span class="keyword">select</span> <span class="keyword">case</span>(adjustl(trim(format)))
<a name="l00662"></a>00662   <span class="keyword">case</span>(<span class="stringliteral">&#39;*&#39;</span>)
<a name="l00663"></a>00663     <span class="keyword">read</span>(unit,*,iostat=err)bc%tp
<a name="l00664"></a>00664     <span class="keyword">do</span> n=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00665"></a>00665       <span class="keyword">select</span> <span class="keyword">case</span>(bc(n)%tp)
<a name="l00666"></a>00666       <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00667"></a>00667         <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n)%inf)) <span class="keyword">deallocate</span>(bc(n)%inf) ; <span class="keyword">allocate</span>(bc(n)%inf) ; <span class="keyword">read</span>(unit,*,iostat=err)bc(n)%inf
<a name="l00668"></a>00668       <span class="keyword">case</span>(bc_adj)
<a name="l00669"></a>00669         <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n)%adj)) <span class="keyword">deallocate</span>(bc(n)%adj) ; <span class="keyword">allocate</span>(bc(n)%adj) ; <span class="keyword">read</span>(unit,*,iostat=err)bc(n)%adj
<a name="l00670"></a>00670       endselect
<a name="l00671"></a>00671     <span class="keyword">enddo</span>
<a name="l00672"></a>00672   <span class="keyword">case</span> default
<a name="l00673"></a>00673     <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc%tp
<a name="l00674"></a>00674     <span class="keyword">do</span> n=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00675"></a>00675       <span class="keyword">select</span> <span class="keyword">case</span>(bc(n)%tp)
<a name="l00676"></a>00676       <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00677"></a>00677         <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n)%inf)) <span class="keyword">deallocate</span>(bc(n)%inf) ; <span class="keyword">allocate</span>(bc(n)%inf)
<a name="l00678"></a>00678         <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc(n)%inf
<a name="l00679"></a>00679       <span class="keyword">case</span>(bc_adj)
<a name="l00680"></a>00680         <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n)%adj)) <span class="keyword">deallocate</span>(bc(n)%adj) ; <span class="keyword">allocate</span>(bc(n)%adj)
<a name="l00681"></a>00681         <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc(n)%adj
<a name="l00682"></a>00682       endselect
<a name="l00683"></a>00683     <span class="keyword">enddo</span>
<a name="l00684"></a>00684   endselect
<a name="l00685"></a>00685   return
<a name="l00686"></a>00686   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00687"></a>00687 <span class="keyword">  endfunction Read_Ascii_Array1D</span>
<a name="l00688"></a>00688 
<a name="l00691"></a>00691   <span class="keyword">function </span>Read_Bin_Array2D(unit,bc) result(err)
<a name="l00692"></a>00692   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00693"></a>00693   <span class="keyword">implicit none</span>
<a name="l00694"></a>00694   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>::    unit    <span class="comment">!&lt; logic unit.</span>
<a name="l00695"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a06d1670084c41c1131e8c234a419e1f7">00695</a>   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc(:,:) <span class="comment">!&lt; boundary conditions data.</span>
<a name="l00696"></a>00696   <span class="keywordtype">integer(I_P)</span>::                 err     <span class="comment">!&lt; error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00697"></a>00697   <span class="keywordtype">integer(I_P)</span>::                 n1,n2   <span class="comment">!&lt; counters.</span>
<a name="l00698"></a>00698   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00699"></a>00699 
<a name="l00700"></a>00700   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00701"></a>00701   <span class="keyword">read</span>(unit,iostat=err)bc%tp
<a name="l00702"></a>00702   <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00703"></a>00703     <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00704"></a>00704       <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2)%tp)
<a name="l00705"></a>00705       <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00706"></a>00706         <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2)%inf)) <span class="keyword">deallocate</span>(bc(n1,n2)%inf) ; <span class="keyword">allocate</span>(bc(n1,n2)%inf)
<a name="l00707"></a>00707         <span class="keyword">read</span>(unit,iostat=err)bc(n1,n2)%inf
<a name="l00708"></a>00708       <span class="keyword">case</span>(bc_adj)
<a name="l00709"></a>00709         <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2)%adj)) <span class="keyword">deallocate</span>(bc(n1,n2)%adj) ; <span class="keyword">allocate</span>(bc(n1,n2)%adj)
<a name="l00710"></a>00710         <span class="keyword">read</span>(unit,iostat=err)bc(n1,n2)%adj
<a name="l00711"></a>00711       endselect
<a name="l00712"></a>00712     <span class="keyword">enddo</span>
<a name="l00713"></a>00713   <span class="keyword">enddo</span>
<a name="l00714"></a>00714   return
<a name="l00715"></a>00715   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00716"></a>00716 <span class="keyword">  endfunction Read_Bin_Array2D</span>
<a name="l00717"></a>00717 
<a name="l00720"></a>00720   <span class="keyword">function </span>Read_Ascii_Array2D(unit,format,bc) result(err)
<a name="l00721"></a>00721   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00722"></a>00722   <span class="keyword">implicit none</span>
<a name="l00723"></a>00723   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>::    unit    <span class="comment">!&lt; Logic unit.</span>
<a name="l00724"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a01185d1f803dceb3bd1d0c81c967adba">00724</a>   <span class="keywordtype">character(*)</span>,  <span class="keywordtype">intent(IN)</span>::    format  <span class="comment">!&lt; Format specifier.</span>
<a name="l00725"></a>00725   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc(:,:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00726"></a>00726   <span class="keywordtype">integer(I_P)</span>::                 err     <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00727"></a>00727   <span class="keywordtype">integer(I_P)</span>::                 n1,n2   <span class="comment">!&lt; Counters.</span>
<a name="l00728"></a>00728   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00729"></a>00729 
<a name="l00730"></a>00730   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00731"></a>00731   <span class="keyword">select</span> <span class="keyword">case</span>(adjustl(trim(format)))
<a name="l00732"></a>00732   <span class="keyword">case</span>(<span class="stringliteral">&#39;*&#39;</span>)
<a name="l00733"></a>00733     <span class="keyword">read</span>(unit,*,iostat=err)bc%tp
<a name="l00734"></a>00734     <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00735"></a>00735       <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00736"></a>00736         <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2)%tp)
<a name="l00737"></a>00737         <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00738"></a>00738           <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2)%inf)) <span class="keyword">deallocate</span>(bc(n1,n2)%inf) ; <span class="keyword">allocate</span>(bc(n1,n2)%inf)
<a name="l00739"></a>00739           <span class="keyword">read</span>(unit,*,iostat=err)bc(n1,n2)%inf
<a name="l00740"></a>00740         <span class="keyword">case</span>(bc_adj)
<a name="l00741"></a>00741           <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2)%adj)) <span class="keyword">deallocate</span>(bc(n1,n2)%adj) ; <span class="keyword">allocate</span>(bc(n1,n2)%adj)
<a name="l00742"></a>00742           <span class="keyword">read</span>(unit,*,iostat=err)bc(n1,n2)%adj
<a name="l00743"></a>00743         endselect
<a name="l00744"></a>00744       <span class="keyword">enddo</span>
<a name="l00745"></a>00745     <span class="keyword">enddo</span>
<a name="l00746"></a>00746   <span class="keyword">case</span> default
<a name="l00747"></a>00747     <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc%tp
<a name="l00748"></a>00748     <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00749"></a>00749       <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00750"></a>00750         <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2)%tp)
<a name="l00751"></a>00751         <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00752"></a>00752           <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2)%inf)) <span class="keyword">deallocate</span>(bc(n1,n2)%inf) ; <span class="keyword">allocate</span>(bc(n1,n2)%inf)
<a name="l00753"></a>00753           <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc(n1,n2)%inf
<a name="l00754"></a>00754         <span class="keyword">case</span>(bc_adj)
<a name="l00755"></a>00755           <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2)%adj)) <span class="keyword">deallocate</span>(bc(n1,n2)%adj) ; <span class="keyword">allocate</span>(bc(n1,n2)%adj)
<a name="l00756"></a>00756           <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc(n1,n2)%adj
<a name="l00757"></a>00757         endselect
<a name="l00758"></a>00758       <span class="keyword">enddo</span>
<a name="l00759"></a>00759     <span class="keyword">enddo</span>
<a name="l00760"></a>00760   endselect
<a name="l00761"></a>00761   return
<a name="l00762"></a>00762   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00763"></a>00763 <span class="keyword">  endfunction Read_Ascii_Array2D</span>
<a name="l00764"></a>00764 
<a name="l00767"></a>00767   <span class="keyword">function </span>Read_Bin_Array3D(unit,bc) result(err)
<a name="l00768"></a>00768   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00769"></a>00769   <span class="keyword">implicit none</span>
<a name="l00770"></a>00770   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>::    unit      <span class="comment">!&lt; logic unit.</span>
<a name="l00771"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#a96a364cd72182d9bbd2c6f935d201ec5">00771</a>   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc(:,:,:) <span class="comment">!&lt; boundary conditions data.</span>
<a name="l00772"></a>00772   <span class="keywordtype">integer(I_P)</span>::                 err       <span class="comment">!&lt; error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00773"></a>00773   <span class="keywordtype">integer(I_P)</span>::                 n1,n2,n3  <span class="comment">!&lt; counters.</span>
<a name="l00774"></a>00774   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00775"></a>00775 
<a name="l00776"></a>00776   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00777"></a>00777   <span class="keyword">read</span>(unit,iostat=err)bc%tp
<a name="l00778"></a>00778   <span class="keyword">do</span> n3=lbound(bc,dim=3),ubound(bc,dim=3)
<a name="l00779"></a>00779     <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00780"></a>00780       <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00781"></a>00781         <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2,n3)%tp)
<a name="l00782"></a>00782         <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00783"></a>00783           <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2,n3)%inf)) <span class="keyword">deallocate</span>(bc(n1,n2,n3)%inf) ; <span class="keyword">allocate</span>(bc(n1,n2,n3)%inf)
<a name="l00784"></a>00784           <span class="keyword">read</span>(unit,iostat=err)bc(n1,n2,n3)%inf
<a name="l00785"></a>00785         <span class="keyword">case</span>(bc_adj)
<a name="l00786"></a>00786           <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2,n3)%adj)) <span class="keyword">deallocate</span>(bc(n1,n2,n3)%adj) ; <span class="keyword">allocate</span>(bc(n1,n2,n3)%adj)
<a name="l00787"></a>00787           <span class="keyword">read</span>(unit,iostat=err)bc(n1,n2,n3)%adj
<a name="l00788"></a>00788         endselect
<a name="l00789"></a>00789       <span class="keyword">enddo</span>
<a name="l00790"></a>00790     <span class="keyword">enddo</span>
<a name="l00791"></a>00791   <span class="keyword">enddo</span>
<a name="l00792"></a>00792   return
<a name="l00793"></a>00793   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00794"></a>00794 <span class="keyword">  endfunction Read_Bin_Array3D</span>
<a name="l00795"></a>00795 
<a name="l00798"></a>00798   <span class="keyword">function </span>Read_Ascii_Array3D(unit,format,bc) result(err)
<a name="l00799"></a>00799   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00800"></a>00800   <span class="keyword">implicit none</span>
<a name="l00801"></a>00801   <span class="keywordtype">integer(I_P)</span>,  <span class="keywordtype">intent(IN)</span>::    unit      <span class="comment">!&lt; Logic unit.</span>
<a name="l00802"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#aff65c3d4f52aaa4479cbb7abbb671779">00802</a>   <span class="keywordtype">character(*)</span>,  <span class="keywordtype">intent(IN)</span>::    format    <span class="comment">!&lt; Format specifier.</span>
<a name="l00803"></a>00803   <span class="keywordtype">type(Type_bc)</span>, <span class="keywordtype">intent(INOUT)</span>:: bc(:,:,:) <span class="comment">!&lt; Boundary conditions data.</span>
<a name="l00804"></a>00804   <span class="keywordtype">integer(I_P)</span>::                 err       <span class="comment">!&lt; Error trapping flag: 0 no errors, &gt;0 error occurs.</span>
<a name="l00805"></a>00805   <span class="keywordtype">integer(I_P)</span>::                 n1,n2,n3  <span class="comment">!&lt; Counters.</span>
<a name="l00806"></a>00806   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00807"></a>00807 
<a name="l00808"></a>00808   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00809"></a>00809   <span class="keyword">select</span> <span class="keyword">case</span>(adjustl(trim(format)))
<a name="l00810"></a>00810   <span class="keyword">case</span>(<span class="stringliteral">&#39;*&#39;</span>)
<a name="l00811"></a>00811     <span class="keyword">read</span>(unit,*,iostat=err)bc%tp
<a name="l00812"></a>00812     <span class="keyword">do</span> n3=lbound(bc,dim=3),ubound(bc,dim=3)
<a name="l00813"></a>00813       <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00814"></a>00814         <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00815"></a>00815           <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2,n3)%tp)
<a name="l00816"></a>00816           <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00817"></a>00817             <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2,n3)%inf)) <span class="keyword">deallocate</span>(bc(n1,n2,n3)%inf) ; <span class="keyword">allocate</span>(bc(n1,n2,n3)%inf)
<a name="l00818"></a>00818             <span class="keyword">read</span>(unit,*,iostat=err)bc(n1,n2,n3)%inf
<a name="l00819"></a>00819           <span class="keyword">case</span>(bc_adj)
<a name="l00820"></a>00820             <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2,n3)%adj)) <span class="keyword">deallocate</span>(bc(n1,n2,n3)%adj) ; <span class="keyword">allocate</span>(bc(n1,n2,n3)%adj)
<a name="l00821"></a>00821             <span class="keyword">read</span>(unit,*,iostat=err)bc(n1,n2,n3)%adj
<a name="l00822"></a>00822           endselect
<a name="l00823"></a>00823         <span class="keyword">enddo</span>
<a name="l00824"></a>00824       <span class="keyword">enddo</span>
<a name="l00825"></a>00825     <span class="keyword">enddo</span>
<a name="l00826"></a>00826   <span class="keyword">case</span> default
<a name="l00827"></a>00827     <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc%tp
<a name="l00828"></a>00828     <span class="keyword">do</span> n3=lbound(bc,dim=3),ubound(bc,dim=3)
<a name="l00829"></a>00829       <span class="keyword">do</span> n2=lbound(bc,dim=2),ubound(bc,dim=2)
<a name="l00830"></a>00830         <span class="keyword">do</span> n1=lbound(bc,dim=1),ubound(bc,dim=1)
<a name="l00831"></a>00831           <span class="keyword">select</span> <span class="keyword">case</span>(bc(n1,n2,n3)%tp)
<a name="l00832"></a>00832           <span class="keyword">case</span>(bc_in1,bc_in2)
<a name="l00833"></a>00833             <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2,n3)%inf)) <span class="keyword">deallocate</span>(bc(n1,n2,n3)%inf) ; <span class="keyword">allocate</span>(bc(n1,n2,n3)%inf)
<a name="l00834"></a>00834             <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc(n1,n2,n3)%inf
<a name="l00835"></a>00835           <span class="keyword">case</span>(bc_adj)
<a name="l00836"></a>00836             <span class="keyword">if</span> (<span class="keyword">allocated</span>(bc(n1,n2,n3)%adj)) <span class="keyword">deallocate</span>(bc(n1,n2,n3)%adj) ; <span class="keyword">allocate</span>(bc(n1,n2,n3)%adj)
<a name="l00837"></a>00837             <span class="keyword">read</span>(unit,adjustl(trim(format)),iostat=err)bc(n1,n2,n3)%adj
<a name="l00838"></a>00838           endselect
<a name="l00839"></a>00839         <span class="keyword">enddo</span>
<a name="l00840"></a>00840       <span class="keyword">enddo</span>
<a name="l00841"></a>00841     <span class="keyword">enddo</span>
<a name="l00842"></a>00842   endselect
<a name="l00843"></a>00843   return
<a name="l00844"></a>00844   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00845"></a>00845 <span class="keyword">  endfunction Read_Ascii_Array3D</span>
<a name="l00846"></a>00846 
<a name="l00847"></a>00847   <span class="comment">! get_bc</span>
<a name="l00850"></a>00850   <span class="keyword">function </span>get_bc_id(myrank,bc_str) result(bc_id)
<a name="l00851"></a>00851   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00852"></a>00852   <span class="keyword">implicit none</span>
<a name="l00853"></a>00853   <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">intent(IN)</span>:: myrank <span class="comment">!&lt; Actual rank process.</span>
<a name="l00854"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#ad7028f1deaa7f37353990f21614f74ae">00854</a>   <span class="keywordtype">character(*)</span>, <span class="keywordtype">intent(IN)</span>:: bc_str <span class="comment">!&lt; String id of boundary condition.</span>
<a name="l00855"></a>00855   <span class="keywordtype">integer(I_P)</span>::             bc_id  <span class="comment">!&lt; Integer id of boundary condition.</span>
<a name="l00856"></a>00856   <span class="keywordtype">integer(I_P)</span>::             b      <span class="comment">!&lt; Boundary conditions counter.</span>
<a name="l00857"></a>00857 <span class="preprocessor">#ifdef MPI2</span>
<a name="l00858"></a>00858   <span class="keywordtype">integer(I_P)</span>::             err    <span class="comment">!&lt; Error for MPI communications.</span>
<a name="l00859"></a>00859 <span class="preprocessor">#endif</span>
<a name="l00860"></a>00860   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00861"></a>00861 
<a name="l00862"></a>00862   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00863"></a>00863   <span class="keyword">do</span> b=1,Nbc
<a name="l00864"></a>00864     <span class="keyword">if</span> (adjustl(trim(bc_str))==adjustl(trim(bc_list_str(b)))) <span class="keyword">then</span>
<a name="l00865"></a>00865       bc_id = bc_list(b)
<a name="l00866"></a>00866       exit
<a name="l00867"></a>00867     elseif (b==Nbc) <span class="keyword">then</span>
<a name="l00868"></a>00868       <span class="keyword">write</span>(stderr,<span class="stringliteral">&#39;(A,I3)&#39;</span>)<span class="stringliteral">&#39; My RANK is: &#39;</span>,myrank
<a name="l00869"></a>00869       <span class="keyword">write</span>(stderr,<span class="stringliteral">&#39;(A)&#39;</span>)   <span class="stringliteral">&#39; Attention!&#39;</span>
<a name="l00870"></a>00870       <span class="keyword">write</span>(stderr,<span class="stringliteral">&#39;(A)&#39;</span>)   <span class="stringliteral">&#39; The boundary condition:&#39;</span>
<a name="l00871"></a>00871       <span class="keyword">write</span>(stderr,<span class="stringliteral">&#39;(A)&#39;</span>)   <span class="stringliteral">&#39; &#39;</span>//adjustl(trim(bc_str))
<a name="l00872"></a>00872       <span class="keyword">write</span>(stderr,<span class="stringliteral">&#39;(A)&#39;</span>)   <span class="stringliteral">&#39; is unknown!&#39;</span>
<a name="l00873"></a>00873 <span class="preprocessor">#ifdef MPI2</span>
<a name="l00874"></a>00874       call MPI_FINALIZE(err)
<a name="l00875"></a>00875 <span class="preprocessor">#endif</span>
<a name="l00876"></a>00876       stop
<a name="l00877"></a>00877     <span class="keyword">endif</span>
<a name="l00878"></a>00878   <span class="keyword">enddo</span>
<a name="l00879"></a>00879   return
<a name="l00880"></a>00880   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00881"></a>00881 <span class="keyword">  endfunction get_bc_id</span>
<a name="l00882"></a>00882 
<a name="l00885"></a>00885   <span class="keyword">function </span>get_bc_str(myrank,bc_id) result(bc_str)
<a name="l00886"></a>00886   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00887"></a>00887   <span class="keyword">implicit none</span>
<a name="l00888"></a>00888   <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">intent(IN)</span>:: myrank <span class="comment">!&lt; Actual rank process.</span>
<a name="l00889"></a><a class="code" href="../../d3/d18/classData__Type__BC.html#ae5694120c71715f06df47cbdb83f2e17">00889</a>   <span class="keywordtype">integer(I_P)</span>, <span class="keywordtype">intent(IN)</span>:: bc_id  <span class="comment">!&lt; Integer id of boundary condition.</span>
<a name="l00890"></a>00890   <span class="keywordtype">character(3)</span>::             bc_str <span class="comment">!&lt; String of boundary condition.</span>
<a name="l00891"></a>00891   <span class="keywordtype">integer(I_P)</span>::             b      <span class="comment">!&lt; Boundary conditions counter.</span>
<a name="l00892"></a>00892 <span class="preprocessor">#ifdef MPI2</span>
<a name="l00893"></a>00893   <span class="keywordtype">integer(I_P)</span>::             err    <span class="comment">!&lt; Error for MPI communications.</span>
<a name="l00894"></a>00894 <span class="preprocessor">#endif</span>
<a name="l00895"></a>00895   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00896"></a>00896 
<a name="l00897"></a>00897   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00898"></a>00898   <span class="keyword">do</span> b=1,Nbc
<a name="l00899"></a>00899     <span class="keyword">if</span> (bc_id==bc_list(b)) <span class="keyword">then</span>
<a name="l00900"></a>00900       bc_str = adjustl(trim(bc_list_str(b)))
<a name="l00901"></a>00901       exit
<a name="l00902"></a>00902     elseif (b==Nbc) <span class="keyword">then</span>
<a name="l00903"></a>00903       <span class="keyword">write</span>(stderr,<span class="stringliteral">&#39;(A,I3)&#39;</span>)<span class="stringliteral">&#39; My RANK is: &#39;</span>,myrank
<a name="l00904"></a>00904       <span class="keyword">write</span>(stderr,<span class="stringliteral">&#39;(A)&#39;</span>)   <span class="stringliteral">&#39; Attention!&#39;</span>
<a name="l00905"></a>00905       <span class="keyword">write</span>(stderr,<span class="stringliteral">&#39;(A)&#39;</span>)   <span class="stringliteral">&#39; The boundary condition:&#39;</span>
<a name="l00906"></a>00906       <span class="keyword">write</span>(stderr,FI_P)    bc_id
<a name="l00907"></a>00907       <span class="keyword">write</span>(stderr,<span class="stringliteral">&#39;(A)&#39;</span>)   <span class="stringliteral">&#39; is unknown!&#39;</span>
<a name="l00908"></a>00908 <span class="preprocessor">#ifdef MPI2</span>
<a name="l00909"></a>00909       call MPI_FINALIZE(err)
<a name="l00910"></a>00910 <span class="preprocessor">#endif</span>
<a name="l00911"></a>00911       stop
<a name="l00912"></a>00912     <span class="keyword">endif</span>
<a name="l00913"></a>00913   <span class="keyword">enddo</span>
<a name="l00914"></a>00914   return
<a name="l00915"></a>00915   <span class="comment">!---------------------------------------------------------------------------------------------------------------------------------</span>
<a name="l00916"></a>00916 <span class="keyword">  endfunction get_bc_str</span>
<a name="l00917"></a>00917 <span class="keyword">endmodule Data_Type_BC</span>
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../d3/dac/Data__Type__BC_8f90.html">Data_Type_BC.f90</a>      </li>

    <li class="footer">Generated on Fri May 4 2012 15:29:27 for OFF by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
